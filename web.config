<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <handlers>
            <!-- This handler tells IIS to pass all requests to the HttpPlatformHandler -->
            <add name="HttpPlatformHandler"
                 path="*"
                 verb="*"
                 modules="httpPlatformHandler"
                 resourceType="Unspecified" />
        </handlers>
        
        <httpPlatform processPath="C:\Program Files\Python314\python.exe"
                      arguments="app.py"
                      stdoutLogEnabled="true"
                      stdoutLogFile=".\python_logs.txt"
                      startupTimeLimit="60"
                      processesPerApplication="1"
                      requestTimeout="60">
            <environmentVariables>
                <!-- This tells the Python app where to find its files -->
                <environmentVariable name="PYTHONPATH" value="." />
                <!-- This tells Flask to run in 'production' mode -->
                <environmentVariable name="FLASK_ENV" value="production" />
            </environmentVariables>
        </httpPlatform>

        <!-- 
        This part is also important. It makes sure IIS serves your
        .css, .js, and .html files as static files, and only gives
        the API calls (like /api/scan) to Python.
        -->
        <staticContent>
            <!-- Add MIME type for .css files if not already present -->
            <mimeMap fileExtension=".css" mimeType="text/css" />
            <!-- Add MIME type for .js files if not already present -->
            <mimeMap fileExtension=".js" mimeType="application/javascript" />
        </staticContent>
        
    </system.webServer>
</configuration>
